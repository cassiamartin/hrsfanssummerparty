<html>

<head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <link rel='stylesheet' type='text/css' href='static/style.css'>
    <link rel="icon" type="image/png" href="static/favicon.png" />
    <script type='text/javascript' src='static/knockout-3.0.0.js'></script>
    <script type='text/javascript' src='static/underscore-min.js'></script>
    <script type='text/javascript' src='static/jquery-2.0.3.min.js'></script>
    <script type='text/javascript' src='static/secret.js'></script>
    <script type='text/javascript' src='static/shared.js'></script>
    <script type='text/javascript' src='static/main.js'></script>
    <title>HRSFANS Retreat Registration</title>
</head>

<body>

    <script type='text/html' id='status-area'>
        <div class=message>
            <span data-bind='text: message'></span>
            <span data-bind='visible: message() && can_set_visible()'> | </span>
            <a
                class='pointer'
                data-bind='text: hide_toggle_text, click: toggle_visible, visible: can_set_visible'
            ></a>
        </div>
    </script>

    <script type='text/html' id='action-area'>
        <button class='reset-button' data-bind='click: reset'>Reset</button>
        <button class='save-button' data-bind='click: submit, visible: allow_submit'>Save</button>
        <span class="note" data-bind='text: change_summary'></span>
    </script>

    <script type='text/html' id='room_group'>
        <table class='res_table'>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <!-- ko foreach: $parent.nights -->
                    <td class='res_day' data-bind='text: name'></td>
                <!-- /ko -->
            </tr>
            <!-- ko foreach: $parent.rooms[$data] --><tr>
                <td class='res_room' data-bind='text: $data.room '></td>
                <td class='res_bed' data-bind='text: $data.bed'></td>
                <td class='res_cost' data-bind='text: _.dollar_val($data.cost)'></td>
                <!-- ko foreach: $parents[1].nights -->
                    <!-- ko with: $parents[2].cells[$data.id + '|' + $parent.id] -->
                        <td
                            class='res_cell'
                            data-bind='text: label, click: toggle, css: style'
                        ></td>
                    <!-- /ko -->
                <!-- /ko -->
            </tr><!-- /ko -->
        </table>
    </script>

    <!-- ko if: loaded -->
    <div class='section header'>
        <p>
            This registration page is for the use of current and former members of HRSFA and members
            of HRSFANS.  If you would like to sign up a guest, please be sure you have read the
            <a href="http://www.multivac.hrsfans.org/index.php?title=Guest_policy">guest policy</a>.
            HRSFANS associate membership is available for non-Harvard-affiliates who have become
            part of the community; if you would like to become a HRSFANS member, you can fill out
            our membership survey and join <a href="http://hrsfans.org/survey/"> here</a>.
        </p>
        <p class='note'>Logged in as: <span data-bind='text: user_nickname'></span></p>
        <p class='logout'>
            <a class="pointer" data-bind='click: refresh_state'>Refresh now</a> |
            <a data-bind='attr: { href: logout_url }'>Log out</a>
        </p>
    </div>

    <!-- ko with: select_attendees --><div class='section' data-bind='css: status'>
        <div data-bind="template: { name: 'status-area', data: $data }"></div>
        <h1>1. Select Attendees</h1>
        <p>
            Enter the email address of each person you are registering.  If you logged in with a
            Google account and are only registering yourself, you can skip this step.
        </p>
        <p>
            If you plan to reserve rooms for someone else, you will need access to their
            registration.
        </p>

        <div class='section-body' data-bind='visible: visible'>
            <div class='authorization-list-container'>
            <table class='authorization-list'>
                <tr>
                    <th class='authorization-status'>Status</th>
                    <th class='authorization-email'>Email</th>
                    <th></th>
                </tr>
                <!-- ko foreach: authorizations --><tr>
                    <td
                        data-bind='
                            text: status,
                            css: { authorization_warning: status != "Active" }
                        '
                    ></td>
                    <td data-bind='text: email'></td>
                    <td class='authorization-remove'>
                        <a class="pointer" data-bind='click: $parent.remove_authorization'>
                            Remove
                        </a>
                    </td>
                </tr><!-- /ko -->
                <tr>
                    <td>Add an email address:</td>
                    <td><input class='email' data-bind='value: pending_email'></input></td>
                    <td class='authorization-remove'>
                        <a class="pointer" data-bind='click: add_authorization'>Add</a>
                    </td>
                </tr>
            </table>
            </div>

            <p>
                An email will be sent to the address you give to confirm that you have permission to
                register it; the recipient will have to click on a link before you can continue.
                If that person has already submitted a registration, you will have access to all
                information they entered, including medical information and financial aid requests.
            </p>
            <p class="note">
                Need to register children without email addresses?  Contact Andrew for a workaround.
            </p>
            <p class='note'>
                This email mechanism is necessary to protect people from accidental or intentional
                privacy violations.  I realize it's an extra complication, and I do apologize.
            </p>
        </div>

        <div
            class='action-area'
            data-bind="
                template: { name: 'action-area', data: $data },
                visible: status() == 'changed'
            "
        ></div>
    </div><!-- /ko -->

    <!-- ko with: register_attendees --><div class='section' data-bind='css: status'>
        <div data-bind="template: { name: 'status-area', data: $data }"></div>
        <h1>2. Register Attendees</h1>
        <p>Enter information for each person you are registering.</p>

        <div class='section-body' data-bind='visible: visible'>
            <p class='note'>
                If you are registering multiple people, we recommend you scroll down and click
                "Save" after finishing each registration.
            </p>
            <!-- ko foreach: registrations --><div class='subsection' data-bind='css: status'>
                <div class=message data-bind='text: message'></div>
                <h2 data-bind='text: email'></h2>
                <table class='reg_table'>
                    <tr class='reg_row'>
                        <td class='reg_label'>
                            Name for display to others (e.g., "Jean-Luc P"; please keep it short!)
                        </td>
                        <td>
                            <input
                                class='reg_input'
                                data-bind='value: name, valueUpdate: "afterkeydown"'
                            ></input>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='reg_label'>Full name</td>
                        <td>
                            <input
                                class='reg_input'
                                data-bind='value: full_name, valueUpdate: "afterkeydown"'
                            ></input>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='reg_label'>Phone number</td>
                        <td>
                            <input
                                class='reg_input'
                                data-bind='value: phone, valueUpdate: "afterkeydown"'
                            ></input>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='reg_label'>
                            What <b>nights</b> are you staying at the party?<br>
                            <span class="note">Click the colored cells to toggle.</span>
                        </td>
                        <td>
                            <table class='reg_subtable' data-bind='foreach: $root.nights'>
                                <tr>
                                    <td class='reg_night' data-bind='text: name + ", " + date'></td>
                                    <!-- ko with: $parent.nights[id]() -->
                                        <td
                                            class='reg_option'
                                            data-bind='text: label, click: toggle, css: style'
                                        ></td>
                                    <!-- /ko -->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='reg_label'>
                            Which meals do you plan to eat?  Selecting "yes" will include the cost
                            of the meal in your registration; for everyone's convenience, please do
                            if applicable.  Otherwise, please choose between "no" and "maybe" to
                            help us estimate the number of people eating each meal.
                            <br>
                            <span class="note">Click the colored cells to toggle.</span>
                        </td>
                        <td>
                            <table class='reg_subtable' data-bind='foreach: $root.party_data.meals'>
                                <tr>
                                    <td class='reg_meal' data-bind='text: name'></td>
                                    <td class='reg_cost' data-bind='text: _.dollar_val(cost)'></td>
                                    <!-- ko with: $parent.meals[id]() -->
                                        <td
                                            class='reg_option'
                                            data-bind='text: label, click: toggle, css: style'
                                        ></td>
                                    <!-- /ko -->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='reg_label'>Please list any dietary restrictions.</td>
                        <td>
                            <textarea
                                class='reg_input'
                                data-bind='value: dietary_restrictions, valueUpdate: "afterkeydown"'
                                style='height: 60px;'
                            ></textarea>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='reg_label'>
                            Is there any medical information we should be aware of?
                        </td>
                        <td>
                            <textarea
                                class='reg_input'
                                data-bind='value: medical, valueUpdate: "afterkeydown"'
                                style='height: 60px;'
                            ></textarea>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='reg_label'>
                            Please provide the name and phone number of an emergency contact.
                        </td>
                        <td>
                            <textarea
                                class='reg_input'
                                data-bind='value: emergency, valueUpdate: "afterkeydown"'
                                style='height: 100px;'
                            ></textarea>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='reg_label'>
                            Are you bringing a car to the party?  If so, can you offer a ride?  If
                            not, are you looking for a ride?
                        </td>
                        <td>
                            <textarea
                                class='reg_input'
                                data-bind='value: driving, valueUpdate: "afterkeydown"'
                                style='height: 60px;'
                            ></textarea>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='reg_label'>
                            If you are attending as a guest of a HRSFA or HRSFANS member, who?
                        </td>
                        <td>
                            <input
                                class='reg_input'
                                data-bind='value: guest_of, valueUpdate: "afterkeydown"'
                            ></input>
                        </td>
                    </tr>
                </table>
            </div><!-- /ko -->
        </div>

        <div
            class='action-area'
            data-bind="
                template: { name: 'action-area', data: $data },
                visible: status() == 'changed'
            "
        ></div>
    </div><!-- /ko -->

    <!-- ko with: reserve_rooms --><div class="section" data-bind='css: status'>
        <div data-bind="template: { name: 'status-area', data: $data }"></div>
        <h1>3. Reserve Rooms</h1>
        <p>
            As with previous years, we are renting two houses, and some people will be staying in
            the Quaker Inn a short walk away.
        </p>
        <div class="section-body" data-bind='visible: visible'>
            <p>
                Some beds are marked "subsidized".  Although accommodation quality was too
                consistent to justify a wide spread in the cost of beds, we wanted some beds to be
                more affordable to the starving artists, poor students, and others among our
                membership whose innumerable talents are not presently translating into a steady
                income.  Please don't be shy about taking a subsidized spot if you would find that
                more appropriate to your present budget &mdash; that's what they're there for.
            </p>
            <p>
                If you want to claim an entire two-person bed for yourself, you're allowed to do
                that; select both slots.  You must, of course, pay for both slots.  If you select
                only one slot, expect the other slot to be taken by somebody else.
            </p>

            <div class="subsection">
                <h2>The Main House</h2>
                <p>
                    The Main House is located at 27 Bath Ave.  Elisabeth will be the host at the
                    Main House.
                </p>
                <div data-bind="template: { name: 'room_group', data: 'main_house' }"></div>
            </div>

            <div class="subsection">
                <h2>The Quiet House</h2>
                <p>
                    The Quiet House is located at 7 Heck Ave., about a 5 minute walk (~7 blocks)
                    away from the Main House. John B will be the host at the Quiet House.  Please
                    note that we anticipate that guests at the Quiet House will generally go to bed
                    and wake up earlier than those in the other locations.
                </p>
                <div data-bind="template: { name: 'room_group', data: 'quiet_house' }"></div>
            </div>

            <div class="subsection">
                <h2>The Hotel</h2>
                <p>
                    The party will be coordinating reservations with The Quaker Inn, located at 39
                    Main Ave. It is about a 5 minute walk (~6 blocks) away from the Main House. In
                    order for us to get a group rate discount, we need to book at least 10 (and
                    preferably 15) rooms at once for two nights of our stay.  We therefore encourage
                    people to sign up for the hotel once the houses fill up (or right away, if you
                    prefer the hotel).
                </p>
                <p>
                    We have tentatively booked the rooms listed below.  We can also book more rooms
                    at similar rates; if the table is full and you want to book a room, contact us
                    for help.
                </p>
                <div data-bind="template: { name: 'room_group', data: 'hotel' }"></div>
                <p>* Hotel rooms 9 and 10 share a bath.</p>
            </div>

            <!-- ko if: display_independent --><div class="subsection">
                <h2>Independent Arrangements</h2>
                <p>
                    If you intend to make independent rooming arrangements, please check the box to
                    confirm; your registration will include a
                    $<span data-bind='text: $root.party_data.independent_night_cost'></span> per
                    night contribution towards party supplies.
                </p>
                <ul class="independent_arrangements" data-bind='foreach: status_by_email'>
                    <!-- ko if: unreserved_nights().length --><li>
                        <input type='checkbox' data-bind='checked: confirmed'></input>
                        <span data-bind='text: reg.name'></span> is making independent
                        rooming arrangements for the following nights:
                        <span data-bind='text: unreserved_nights().join(", ")'></span>
                    </li><!-- /ko -->
                </ul>
            </div><!-- /ko -->
        </div>

        <div
            class='action-area'
            data-bind="
                template: { name: 'action-area', data: $data },
                visible: status() == 'changed'
            "
        ></div>
    </div><!-- /ko -->

    <!-- ko with: pay_for_registration --><div class="section" data-bind='css: status'>
        <div data-bind="template: { name: 'status-area', data: $data }"></div>
        <h1>4. Pay for Registration</h1>
        <div class="section-body" data-bind='visible: visible'>
            <p>
                Before paying for your registrations, please let us know if you would like to
                participate in the transportation subsidy or financial assistance programs.  See
                <a href="http://www.multivac.hrsfans.org/index.php?title=Retreat_2014#Transport_Subsidy_and_Financial_Assistance">
                the wiki</a> for more.  All contributors and recipients are confidential.
            </p>
            <!-- ko foreach: sections --><div class='subsection' data-bind='css: status'>
                <h2 data-bind='text: srv_data.email'></h2>
                <div class='pmt_subsection'>
                    <p>
                        <input
                            type='radio'
                            value='requesting'
                            data-bind='
                                checked: transport_choice,
                                attr: { name: "travel" + $index() }
                            '
                        ></input>
                        I anticipate significant transportation expenses (such as a long-distance
                        flight) and would like to request a transportation subsidy of
                        $<input
                            class='money'
                            data-bind='
                                enable: transport_choice() == "requesting",
                                value: transport_value,
                                valueUpdate: "afterkeydown"
                            '
                        </input>.
                        At this time we are accepting requests of $100; if there are enough
                        contributions, we will ask how much your travel expenses were and increase
                        subsidies appropriately.
                    </p>
                    <p>
                        <input
                            type='radio'
                            value='contributing'
                            data-bind='
                                checked: transport_choice,
                                attr: { name: "travel" + $index() }
                            '
                        ></input>
                        I would like to contribute
                        $<input
                            class='money'
                            data-bind='
                                enable: transport_choice() == "contributing",
                                value: transport_value,
                                valueUpdate: "afterkeydown"
                            '
                        ></input>
                        to the transportation subsidy.  For those who are comfortable, we suggest
                        a contribution of $10 per night, but any amount is appreciated.
                    </p>
                    <p>
                        <input
                            type='radio'
                            value='none'
                            data-bind='
                                checked: transport_choice,
                                attr: { name: "travel" + $index() }
                            '
                        ></input>
                        I would not like to participate in the transportation subsidy.
                    </p>
                </div>

                <div class='pmt_subsection'>
                    <p>
                        <input
                            type='radio'
                            value='requesting'
                            data-bind='
                                checked: assistance_choice,
                                attr: { name: "assistance" + $index() }
                            '
                        ></input>
                        I am seeking assistance of
                        $<input
                            class="money"
                            data-bind='
                                enable: assistance_choice() == "requesting",
                                value: assistance_value,
                                valueUpdate: "afterkeydown"
                            '
                        ></input>
                        in order to attend the party.  Please
                        <a href="http://www.multivac.hrsfans.org/index.php?title=Retreat_2014#Contact_the_Winter_Party_Team">
                        contact us</a> before sending payment if you select this option.
                    </p>
                    <p>
                        <input
                            type='radio'
                            value='contributing'
                            data-bind='
                                checked: assistance_choice,
                                attr: { name: "assistance" + $index() }
                            '
                        ></input>
                        I would like to pledge up to
                        $<input
                            class="money"
                            data-bind='
                                enable: assistance_choice() == "contributing",
                                value: assistance_pledge,
                                valueUpdate: "afterkeydown"
                            '
                        ></input>
                        to help others attend the party.  Please include
                        $<input
                            class="money"
                            data-bind='
                                enable: assistance_choice() == "contributing",
                                value: assistance_value,
                                valueUpdate: "afterkeydown"
                            '
                        ></input>
                        of this amount in my registration.  We rarely have to ask for more than $10
                        from any contributor; if you include this amount now, it is likely we will
                        not need to ask you again.
                    </p>
                    <p>
                        <input
                            type='radio'
                            value='none'
                            data-bind='
                                checked: assistance_choice,
                                attr: { name: "assistance" + $index() }
                            '
                        ></input>
                        I would not like to participate in financial assistance.
                    </p>
                </div>
                <table class='pmt_table'><tbody>
                    <!-- ko foreach: srv_data.costs --><tr>
                        <td
                            class='pmt_group'
                            data-bind='text: $index() == 0 ? "Charges" : ""'
                        ></td>
                        <td
                            class='pmt_label pmt_charge'
                            data-bind='text: label'
                        ></td>
                        <td
                            class='pmt_value pmt_charge'
                            data-bind='text: _.dollar_val(value, 2)'
                        ></td>
                    </tr><!-- /ko -->
                    <!-- ko foreach: srv_data.credits --><tr>
                        <td
                            class='pmt_group'
                            data-bind='text: $index() == 0 ? "Payments" : ""'
                        ></td>
                        <td
                            class='pmt_label pmt_credit'
                            data-bind='text: label'
                        ></td>
                        <td
                            class='pmt_value pmt_credit'
                            data-bind='text: _.dollar_val(value, 2)'
                        ></td>
                    </tr><!-- /ko -->
                    <tr>
                        <td class='pmt_group'>Total</td>
                        <td
                            class='pmt_label'
                            data-bind='
                                text: $parent.total_label(srv_data.due),
                                css: $parent.total_style(srv_data.due)
                            '
                        ></td>
                        <td
                            class='pmt_value'
                            data-bind='
                                text: _.dollar_val(Math.abs(srv_data.due), 2),
                                css: $parent.total_style(srv_data.due)
                            '
                        ></td>
                    </tr>
                </tbody></table>
            </div><!-- /ko -->

            <!-- ko if: display_section() == 'due' -->
            <p>
                 A total of <b><span data-bind='text: _.dollar_val(Math.abs(total_due()), 2)'>
                 </span></b> is due for the above registrations.  <b>Please pay promptly.</b>  If
                 you are not paying for all of these registrations, please make sure the other
                 people know how much they owe.
            </p>

            <p>
                Please send Andrew your payment via one of the following.
                <ul>
                    <li>
                        PayPal to onethreeseven@gmail.com.  Through some trial and error, we've
                        discovered that some of the ways of doing this will quietly cause some of
                        the money to disappear on its way to us, despite all claims to the contrary.
                        Please be sure to follow these steps:
                        <ol>
                            <li>
                                <b>Log into your PayPal account.</b><br>
                                <i>If you see a splash screen with the options "Buy", "Sell", and
                                "Transfer" at the top, you are <b>not</b> yet at the right screen.
                                Click the PayPal logo to get to your account page.</i>
                            </li>
                            <li>
                                Choose the "Send Money" tab, which should be the second one, after
                                "My Account".
                            </li>
                            <li>Enter the appropriate payment.</li>
                            <li>
                                <b>Select "I'm sending money to family or friends", rather than
                                "I'm paying for goods or services".</b><br>
                                <i>If you do not see this <b>exact</b> choice, no matter how much
                                it looks like PayPal will not charge a fee, it will.  I find this
                                disgustingly fraudulent, but for this party at least we are stuck
                                with it. &mdash; Andrew</i>
                            </li>
                            <li>Complete the payment.</li>
                        </ol>
                    </li>
                    <li>Check to:
                        <div class='address'>
                            <span data-bind='text: window.secret.address_1'></span><br/>
                            <span data-bind='text: window.secret.address_2'></span><br/>
                            <span data-bind='text: window.secret.address_3'></span>
                        </div>
                    </li>
                    <li>
                        Check or cash in person.  Please don't use this option if it will take more
                        than a week.
                    </li>
                </ul>
                If you are paying for multiple registrations or under a different name or email
                address, please make it clear for whom you are paying.
            </p>
            <!-- /ko -->

            <!-- ko if: display_section() == 'excess' -->
            <p>
                You seem to have overpaid by a total of
                <b><span data-bind='text: _.dollar_val(Math.abs(total_due()), 2)'></span></b>.
                Perhaps you are claiming subsidies or financial aid in excess of your party costs,
                your payment was in the incorrect amount, it was entered incorrectly, or you changed
                your registration after sending it in.  Please contact Andrew to resolve the
                situation.
            </p>
            <!-- /ko -->

            <!-- ko if: display_section() == 'zero' -->
            <p>
                Thanks for paying!  If you have any concerns with your registration, don't hesitate
                to contact us.
            </p>
            <!-- /ko -->
        </div>

        <div
            class='action-area'
            data-bind="
                template: { name: 'action-area', data: $data },
                visible: status() == 'changed'
            "
        ></div>
    </div><!-- /ko -->

    <!-- ko with: guest_list --><div class="section header">
        <h1>5. Check Out the Wiki</h1>
        <div data-bind="template: { name: 'status-area', data: $data }"></div>
        <p>
            We're still using the
            <a href="http://www.multivac.hrsfans.org/index.php?title=Retreat_2014">wiki</a> to
            organize carpools, activities, games, cooking, and cleaning.  Head over there to sign up
            for these things!
        </p>

        <div class="section-body" data-bind='visible: visible'>
            <p>
                Also, here are the <span data-bind='text: guests().length'></span> people who are
                coming to the party, and when:
            </p>
            <table class='guest_list'>
                <tr>
                    <td></td>
                    <!-- ko foreach: $root.party_data.days -->
                        <td class='guest_day' data-bind='text: name'></td>
                    <!-- /ko -->
                </tr>
                <!-- ko foreach: guests -->
                <tr>
                    <td class='guest_name' data-bind='text: name'></td>
                    <!-- ko foreach: $root.party_data.days -->
                        <td
                            class='guest_cell'
                            data-bind='css: $parents[1].class_for_cell($index(), $parent.nights)'
                        ></td>
                    <!-- /ko -->
                </tr>
                <!-- /ko -->
            </table>
        </div>

    </div><!-- /ko -->
    <!-- /ko -->

</body>

</html>
