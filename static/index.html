<html>

<head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <link rel='stylesheet' type='text/css' href='static/style.css'>
    <link rel="icon" type="image/png" href="static/favicon.png" />
    <script type='text/javascript' src='static/knockout-3.2.0.js'></script>
    <script type='text/javascript' src='static/underscore-min.js'></script>
    <script type='text/javascript' src='static/jquery-2.1.1.min.js'></script>
    <script type='text/javascript' src='static/shared.js'></script>
    <script type='text/javascript' src='static/main.js'></script>
    <title>HRSFANS Retreat Registration</title>
</head>

<body>

    <script type='text/html' id='action-area'>
        <button class='bg_red pointer' data-bind='click: reset'>Reset</button>
        <button class='save-button' data-bind='click: submit, visible: allow_submit'>Save</button>
        <span class='note' data-bind='text: change_summary'></span>
    </script>

    <script type='text/html' id='room_group'>
        <table class='res_table'>
            <tr>
                <td class='borderless'></td>
                <td class='borderless'></td>
                <!-- ko foreach: $root.nights -->
                    <td class='bg_gray' colspan='2' data-bind='text: name'></td>
                <!-- /ko -->
            </tr>
            <!-- ko foreach: $root.party_data.rooms[$data] -->
                <!-- ko foreach: beds --><tr>
                    <td
                        class='cell_label_wide bg_gray'
                        data-bind='text: $index() ? "" : $parent.room'
                    ></td>
                    <td class='cell_label_short bg_gray' data-bind='text: bed'></td>
                    <!-- ko foreach: $root.nights -->
                        <!-- ko with: $parents[3].cells[id + '|' + $parent.id] -->
                            <td
                                class='cell_name_short'
                                data-bind='text: label, click: toggle, css: style'
                            ></td>
                            <td
                                class='cell_cost bg_gray'
                                data-bind='text: _.dollar_val($parents[1].costs[$parent.id])'
                            ></td>
                        <!-- /ko -->
                    <!-- /ko -->
                </tr><!-- /ko -->
            <!-- /ko -->
        </table>
    </script>

    <!-- ko if: loaded -->

    <div class='header_section header'>
        <p>
            This registration page is for the use of current and former members of HRSFA and members
            of HRSFANS.
        </p>
        <p class='note'>Logged in as: <span data-bind='text: user_nickname'></span></p>
        <p class='logout'>
            <a class="pointer" data-bind='click: refresh_state'>Refresh now</a> |
            <a data-bind='attr: { href: logout_url }'>Log out</a>
        </p>
    </div>

    <div class='selector_section'>
        <!-- ko foreach: sections -->
            <div class='section_selector_container'>
                <div
                    class='section_selector'
                    data-bind='text: label, css: status_for_selector, click: try_set_visible'
                ></div>
            </div>
        <!-- /ko -->
    </div>

    <!-- ko with: select_attendees -->
        <div class="section" data-bind='css: status, visible: $parent.visible_section() == $data'>
            <div class='message' data-bind='text: message'></div>

            <p>
                You have access to the following registrations.  To register friends or family, or
                if you logged in with a non-Google account, add email addresses below.  If your
                child does not have an email address, you can work around this by providing your own
                under his or her name, in the format
                &quot;Adam Young&lt;mister_young@gmail.com&gt;&quot;.
            </p>

            <div class='authorization-list-container'>
                <table class='authorization-list'>
                    <tr>
                        <th>Email</th>
                        <th>Status</th>
                        <th></th>
                    </tr>
                    <!-- ko foreach: authorizations --><tr>
                        <td class='borderless cell_info_wide' data-bind='text: email'></td>
                        <td
                            class='borderless cell_info_medium'
                            data-bind='
                                text: status,
                                css: { color_red: status != "Active" }
                            '
                        ></td>
                        <td class='borderless'>
                            <a class="pointer" data-bind='click: $parent.remove_authorization'>
                                Remove
                            </a>
                        </td>
                    </tr><!-- /ko -->
                    <tr>
                        <td class='borderless cell_info_wide'>
                            <input class='auth_input' data-bind='value: pending_email'></input>
                        </td>
                        <td class='borderless cell_info_medium'></td>
                        <td class='borderless'>
                            <a class="pointer" data-bind='click: add_authorization'>Add</a>
                        </td>
                    </tr>
                </table>
            </div>

            <p data-bind="visible: !$root.is_admin">
                A confirmation link will be emailed to any addresses you add.  Note that if
                confirmed, you will gain access to any existing registrations for those addresses,
                including potentially private information.
            </p>
            <p data-bind="visible: $root.is_admin">
                You have administrator access, so no confirmation emails will be sent.
            </p>

            <div
                class='action-area'
                data-bind="
                    template: { name: 'action-area', data: $data },
                    visible: status() == 'changed'
                "
            ></div>
        </div>
    <!-- /ko -->

    <!-- ko with: register_attendees -->
        <div class="section" data-bind='css: status, visible: $parent.visible_section() == $data'>
            <div class='message' data-bind='text: message'></div>

            <p>
                In order to keep accurate records, guests and most children need to be registered.
                (Children who will neither eat party meals nor take a bed slot are an exception.)
                You can add people to your registration using the "Add Emails" tab.  We have plans
                to streamline group registrations in future, but please bear with us for now.
            </p>

            <!-- ko foreach: sections --><div class='subsection' data-bind='css: status'>
                <div class='message' data-bind='text: message'></div>
                <h2 data-bind='text: email'></h2>
                <table class='reg_table'>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>
                            Name for display (please keep it short!)
                        </td>
                        <td class='borderless'>
                            <input
                                class='reg_input'
                                data-bind='value: name, valueUpdate: "afterkeydown"'
                            ></input>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>Full name</td>
                        <td class='borderless'>
                            <input
                                class='reg_input'
                                data-bind='value: full_name, valueUpdate: "afterkeydown"'
                            ></input>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>Phone number</td>
                        <td class='borderless'>
                            <input
                                class='reg_input'
                                data-bind='value: phone, valueUpdate: "afterkeydown"'
                            ></input>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>
                            What <b>nights</b> are you staying at the party?<br>
                        </td>
                        <td class='borderless'>
                            <table class='reg_subtable' data-bind='foreach: $root.nights'>
                                <tr>
                                    <td
                                        class='cell_label_medium_plus_cost bg_gray'
                                        data-bind='text: name + ", " + date'
                                    ></td>
                                    <!-- ko with: $parent.nights[id] -->
                                        <td
                                            class='reg_option pointer'
                                            data-bind='text: label, click: toggle, css: style'
                                        ></td>
                                    <!-- /ko -->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>
                            Which meals do you plan to eat?  Selecting "yes" will include the cost
                            of the meal in your registration; for everyone's convenience, please do
                            if applicable.  Otherwise, please choose between "no" and "maybe" to
                            help us estimate the number of people eating each meal.
                            <br>
                        </td>
                        <td class='borderless'>
                            <table class='reg_subtable' data-bind='foreach: $root.party_data.meals'>
                                <tr>
                                    <td
                                        class='cell_label_medium bg_gray'
                                        data-bind='text: name'
                                    ></td>
                                    <td
                                        class='cell_cost bg_gray'
                                        data-bind='text: _.dollar_val(cost)'
                                    ></td>
                                    <!-- ko with: $parent.meals[id] -->
                                        <td
                                            class='reg_option pointer'
                                            data-bind='text: label, click: toggle, css: style'
                                        ></td>
                                    <!-- /ko -->
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>
                            Please provide the name and phone number of an emergency contact.
                        </td>
                        <td class='borderless'>
                            <textarea
                                class='reg_input'
                                data-bind='value: emergency, valueUpdate: "afterkeydown"'
                                style='height: 60px;'
                            ></textarea>
                        </td>
                    </tr>
                </table>

                <h3>Additional Information (please leave blank unless applicable)</h3>
                <table class='reg_table'>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>
                            Are you planning to bring a car to the party, and if so, are you willing
                            to drive for the party?  (We will reimburse you for driving expenses.)
                        </td>
                        <td class='borderless'>
                            <textarea
                                class='reg_input'
                                data-bind='value: driving, valueUpdate: "afterkeydown"'
                                style='height: 60px;'
                            ></textarea>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>
                            Please list any dietary restrictions we should be aware of.
                        </td>
                        <td class='borderless'>
                            <textarea
                                class='reg_input'
                                data-bind='value: dietary, valueUpdate: "afterkeydown"'
                                style='height: 60px;'
                            ></textarea>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>
                            Please list any medical information we should be aware of.
                        </td>
                        <td class='borderless'>
                            <textarea
                                class='reg_input'
                                data-bind='value: medical, valueUpdate: "afterkeydown"'
                                style='height: 60px;'
                            ></textarea>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>
                            If you plan to bring children who will not occupy a reserved bed, please
                            list their names and ages.
                        </td>
                        <td class='borderless'>
                            <textarea
                                class='reg_input'
                                data-bind='value: children, valueUpdate: "afterkeydown"'
                                style='height: 60px;'
                            ></textarea>
                        </td>
                    </tr>
                    <tr class='reg_row'>
                        <td class='borderless reg_label'>
                            If you are attending as a guest of a HRSFA or HRSFANS member, who is it?
                        </td>
                        <td class='borderless'>
                            <input
                                class='reg_input'
                                data-bind='value: guest, valueUpdate: "afterkeydown"'
                            ></input>
                        </td>
                    </tr>
                </table>
            </div><!-- /ko -->

            <div
                class='action-area'
                data-bind="
                    template: { name: 'action-area', data: $data },
                    visible: status() == 'changed'
                "
            ></div>
        </div>
    <!-- /ko -->

    <!-- ko with: reserve_rooms -->
        <div class="section" data-bind='css: status, visible: $parent.visible_section() == $data'>
            <div class='message' data-bind='text: message'></div>

            <p>
                We're returning to our usual house in Ocean Grove, New Jersey, although this year we
                are not renting a quiet house.  Once again, we are coordinating group reservations
                at the Quaker Inn, a short walk away.
            </p>
            <p>
                If you want to claim an entire two-person bed for yourself, you're allowed to do
                that; select both slots.  You must, of course, pay for both slots.  If you select
                only one slot, expect the other slot to be taken by somebody else.
            </p>
            <p>
                Feel free to make your own rooming arrangements; we will include a charge of $6 per
                night to cover snacks and house supplies.
            </p>

            <div class="subsection">
                <h2>The House</h2>
                <p>Tom will be co-hosting at the house.</p>
                <div data-bind="template: { name: 'room_group', data: 'house' }"></div>
            </div>

            <div class="subsection">
                <h2>The Hotel</h2>
                <div data-bind="template: { name: 'room_group', data: 'hotel' }"></div>
            </div>

            <div
                class='action-area'
                data-bind="
                    template: { name: 'action-area', data: $data },
                    visible: status() == 'changed'
                "
            ></div>
        </div>
    <!-- /ko -->

    <!-- ko with: finalize -->
        <div class="section" data-bind='css: status, visible: $parent.visible_section() == $data'>
            <div class='message' data-bind='text: message'></div>

            <p>
                Please let us know if you would like to participate in the transportation subsidy or
                financial assistance programs.  See
                <a href="http://www.multivac.hrsfans.org/index.php?title=Retreat_2014#Transport_Subsidy_and_Financial_Assistance">
                the wiki</a> for more.  All contributors and recipients are confidential.
            </p>

            <p>
                Finally, please confirm your registration.  By confirming your registration, you
                indicate that:
                <ul>
                    <li>
                        You agree to pay for your registration in a timely fashion.  If you are
                        requesting financial aid, or need to delay payment for any reason,
                        <a href="http://www.multivac.hrsfans.org/index.php?title=Summer_Party_2014#Contact_the_Summer_Party_Team">
                        contact us</a> <b>before</b> confirming your registration.
                    </li>
                    <li>
                        If you are attending as a guest, and especially if you are bringing a guest,
                        you agree to the provisions of the
                        <a href="http://www.multivac.hrsfans.org/index.php?title=Guest_policy">
                        guest policy</a>.
                    </li>
                    <li>
                        You agree to the provisions of the HRSFANS
                        <a href="https://docs.google.com/document/d/1cqa1G9eDkL-pEav8EqqmY5K2R3dVBbyocSNn-JCwQG4">
                        policy on harassment</a>.
                    </li>
                </ul>
                Do not confirm a registration on behalf of another person unless you have confirmed
                that that person has also read these provisions.
            </p>

            <!-- ko foreach: sections --><div class='subsection' data-bind='css: status'>
                <h2 data-bind='text: email'></h2>
                <div class='message' data-bind='text: message'></div>
                <div class='pmt_subsection'>
                    <p>
                        <input
                            type='radio'
                            value='requesting'
                            data-bind='checked: subsidy_choice, attr: { name: "travel" + $index() }'
                        ></input>
                        I anticipate significant transportation expenses (such as a long-distance
                        flight) and would like to request a transportation subsidy of
                        $<input
                            class='money'
                            data-bind='
                                enable: subsidy_choice() == "requesting",
                                value: subsidy_value,
                                valueUpdate: "afterkeydown"
                            '
                        </input>.
                        At this time we are accepting requests of $100; if there are enough
                        contributions, we will ask how much your travel expenses were and increase
                        subsidies appropriately.
                    </p>
                    <p>
                        <input
                            type='radio'
                            value='contributing'
                            data-bind='checked: subsidy_choice, attr: { name: "travel" + $index() }'
                        ></input>
                        I would like to contribute
                        $<input
                            class='money'
                            data-bind='
                                enable: subsidy_choice() == "contributing",
                                value: subsidy_value,
                                valueUpdate: "afterkeydown"
                            '
                        ></input>
                        to the transportation subsidy.  For those who are comfortable, we suggest
                        a contribution of $10 per night, but any amount is appreciated.
                    </p>
                    <p>
                        <input
                            type='radio'
                            value='none'
                            data-bind='checked: subsidy_choice, attr: { name: "travel" + $index() }'
                        ></input>
                        I would not like to participate in the transportation subsidy.
                    </p>
                </div>

                <div class='pmt_subsection'>
                    <p>
                        <input
                            type='radio'
                            value='requesting'
                            data-bind='checked: aid_choice, attr: { name: "assistance" + $index() }'
                        ></input>
                        I am seeking assistance of
                        $<input
                            class="money"
                            data-bind='
                                enable: aid_choice() == "requesting",
                                value: aid_value,
                                valueUpdate: "afterkeydown"
                            '
                        ></input>
                        in order to attend the party.
                    </p>
                    <p>
                        <input
                            type='radio'
                            value='contributing'
                            data-bind='checked: aid_choice, attr: { name: "assistance" + $index() }'
                        ></input>
                        I would like to pledge up to
                        $<input
                            class="money"
                            data-bind='
                                enable: aid_choice() == "contributing",
                                value: aid_pledge,
                                valueUpdate: "afterkeydown"
                            '
                        ></input>
                        to help others attend the party.  Please include
                        $<input
                            class="money"
                            data-bind='
                                enable: aid_choice() == "contributing",
                                value: aid_value,
                                valueUpdate: "afterkeydown"
                            '
                        ></input>
                        of this amount in my registration.  We rarely have to ask for more than $10
                        from any contributor; if you include this amount now, it is likely we will
                        not need to ask you again.
                    </p>
                    <p>
                        <input
                            type='radio'
                            value='none'
                            data-bind='checked: aid_choice, attr: { name: "assistance" + $index() }'
                        ></input>
                        I would not like to participate in financial assistance.
                    </p>
                </div>

                <div class='pmt_subsection'>
                    <p>
                        <input type='checkbox' data-bind='checked: confirmed'></input>
                        I agree to pay for this registration and confirm that I have read and
                        understood the retreat policies listed above.
                    </p>
                </div>
            </div><!-- /ko -->

            <div
                class='action-area'
                data-bind="
                    template: { name: 'action-area', data: $data },
                    visible: status() == 'changed'
                "
            ></div>
        </div>
    <!-- /ko -->

    <!-- ko with: payment -->
        <div class="section" data-bind='css: status, visible: $parent.visible_section() == $data'>
            <div class='message' data-bind='text: message'></div>

            <!-- ko foreach: sections --><div class='subsection' data-bind='css: status'>
                <h2 data-bind='text: email'></h2>
                <table class='pmt_table'><tbody>
                    <tr>
                        <td class='borderless pmt_group'>Items</td>
                        <td class='cell_info_wide bg_slate'>Rooms</td>
                        <td
                            class='cell_value bg_slate'
                            data-bind='text: _.dollar_val(rooms, 2)'
                        ></td>
                    </tr>
                    <tr>
                        <td class='borderless pmt_group'></td>
                        <td class='cell_info_wide bg_slate'>Meals</td>
                        <td
                            class='cell_value bg_slate'
                            data-bind='text: _.dollar_val(meals, 2)'
                        ></td>
                    </tr>
                    <!-- ko if: aid != 0 --><tr>
                        <td class='borderless pmt_group'></td>
                        <td class='cell_info_wide bg_slate'>Financial assistance</td>
                        <td
                            class='cell_value bg_slate'
                            data-bind='text: _.dollar_val(aid, 2)'
                        ></td>
                    </tr><!-- /ko -->
                    <!-- ko if: subsidy != 0 --><tr>
                        <td class='borderless pmt_group'></td>
                        <td class='cell_info_wide bg_slate'>Transport subsidy</td>
                        <td
                            class='cell_value bg_slate'
                            data-bind='text: _.dollar_val(subsidy, 2)'
                        ></td>
                    </tr><!-- /ko -->
                    <!-- ko foreach: credits --><tr>
                        <td
                            class='borderless pmt_group'
                            data-bind='text: $index() == 0 ? "Payments" : ""'
                        ></td>
                        <td
                            class='cell_info_wide bg_green'
                            data-bind='text: "Payment / (refund) recorded " + date'
                        ></td>
                        <td
                            class='cell_value bg_green'
                            data-bind='text: _.dollar_val(amount, 2)'
                        ></td>
                    </tr><!-- /ko -->
                    <!-- ko foreach: expenses --><tr>
                        <td
                            class='borderless pmt_group'
                            data-bind='text: $index() == 0 ? "Credits" : ""'
                        ></td>
                        <td
                            class='cell_info_wide bg_slate'
                            data-bind='text: "Credit recorded " + date'
                        ></td>
                        <td
                            class='cell_value bg_slate'
                            data-bind='text: _.dollar_val(amount, 2)'
                        ></td>
                    </tr><!-- /ko -->
                    <tr>
                        <td class='borderless pmt_group'>Total</td>
                        <td
                            class='cell_info_wide'
                            data-bind='
                                text: $parent.total_label(due),
                                css: $parent.total_style(due)
                            '
                        ></td>
                        <td
                            class='cell_value'
                            data-bind='
                                text: _.dollar_val(Math.abs(due), 2),
                                css: $parent.total_style(due)
                            '
                        ></td>
                    </tr>
                </tbody></table>
            </div><!-- /ko -->

            <!-- ko if: display_section() == 'due' -->
            <p>
                 A total of <b><span data-bind='text: _.dollar_val(Math.abs(total_due()), 2)'>
                 </span></b> is due for the above registrations.  <b>Please pay promptly.</b>  If
                 you are not paying for all of these registrations, please make sure the other
                 people know how much they owe.
            </p>

            <p>
                Please send Andrew your payment via one of the following.  For any questions, email
                him at onethreeseven@gmail.com.
                <ul>
                    <li>
                        <b>(Preferred)</b> Venmo.  If you don't have an account, sign up at
                        <a href="http://venmo.com/">venmo.com</a>; it's easy.  Then use
                        <a href="https://venmo.com/onethreeseven">this link</a> to send your
                        payment.
                    </li>
                    <li>
                        Check or cash in person, if you will see Andrew in the next week or two.
                    </li>
                    <li>
                        Check by mail.  Send an email if you don't have Andrew's address.
                    </li>
                    <li>
                        <b>(As a last resort)</b> PayPal.  This is a last resort because we have
                        discovered that many ways of using the PayPal interface will quietly cause
                        a percentage of the money to disappear on its way to us, despite all claims
                        to the contrary.  If you must use PayPal, send an email for instructions.
                    </li>
                </ul>
            </p>
            <!-- /ko -->

            <!-- ko if: display_section() == 'excess' -->
            <p>
                You seem to have overpaid by a total of
                <b><span data-bind='text: _.dollar_val(Math.abs(total_due()), 2)'></span></b>.
                Perhaps you are requesting subsidies or financial aid in excess of your party costs,
                your payment was in the incorrect amount, or you changed your registration.  Andrew
                will be in touch to resolve the situation.
            </p>
            <!-- /ko -->

            <!-- ko if: display_section() == 'zero' -->
            <p>
                Thanks for paying!  If you have any concerns with your registration, don't hesitate
                to contact us.
            </p>
            <!-- /ko -->
        </div>
    <!-- /ko -->

    <!-- ko with: guest_list -->
        <div class="section" data-bind='css: status, visible: $parent.visible_section() == $data'>
            <p>
                We're still using the
                <a href="http://multivac.hrsfans.org/index.php?title=Retreat_2015">wiki</a>
                to organize activities, games, cooking, and cleaning.  Head over there to sign up
                for these things!
            </p>

            <p>
                Also, here are the <span data-bind='text: guests().length'></span> people who are
                coming to the party, and when:
            </p>
            <table class='guest_list'>
                <tr>
                    <td class='borderless'></td>
                    <!-- ko foreach: $root.party_data.days -->
                        <td
                            class='guest_day bg_gray'
                            data-bind='
                                text: name +
                                ($parent.counts()[id] > 0 ? " (" + $parent.counts()[id] + ")" : "")
                            '
                        ></td>
                    <!-- /ko -->
                </tr>
                <!-- ko foreach: guests -->
                <tr>
                    <td class='cell_name bg_gray' data-bind='text: name'></td>
                    <!-- ko foreach: $root.party_data.days -->
                        <td
                            data-bind='css: $parents[1].class_for_cell($index(), $parent.nights)'
                        ></td>
                    <!-- /ko -->
                </tr>
                <!-- /ko -->
            </table>
        </div>
    <!-- /ko -->

    <!-- /ko -->

</body>

</html>
